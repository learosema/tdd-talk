<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="author" content="Lea Rosema"/><meta name="keywords" content="Eleventy, Static Site Generator"/><link rel="stylesheet" href="css/index.css"/><title>TDD</title></head><body><main><section class="slide" id="slide_1" tabindex="-1"><h1>TDD with Jest+TypeScript</h1>
</section><section class="slide" id="slide_2" tabindex="-1">
<h1>Hi! I'm Lea Rosema</h1>
<ul>
<li>Pronouns: she/her</li>
<li>Frontend Developer at SinnerSchrader, Part of Accenture Interactive</li>
<li><a target="_blank" rel="noopener noreferer" href="https://codepen.io/terabaud/">https://codepen.io/terabaud/</a></li>
<li><a target="_blank" rel="noopener noreferer" href="https://lea.codes/">https://lea.codes/</a></li>
<li><a target="_blank" rel="noopener noreferer" href="https://twitter.com/terabaud/">@terabaud</a></li>
</ul>
</section><section class="slide" id="slide_3" tabindex="-1">
<h1>Link to Slides and Code</h1>
<ul>
<li><a target="_blank" rel="noopener noreferer" href="https://terabaud.github.io/tdd-talk/">https://terabaud.github.io/tdd-talk/</a></li>
<li><a target="_blank" rel="noopener noreferer" href="https://github.com/terabaud/tdd-code/">https://github.com/terabaud/tdd-code/</a></li>
</ul>
</section><section class="slide" id="slide_4" tabindex="-1">
<h1>Structure of this talk</h1>
<ul>
<li>Introduction to TDD</li>
<li>Kinds of tests</li>
<li>Jest+TypeScript Basic Setup</li>
<li>What are mocks and how to do them in jest</li>
<li>Go through real life code examples</li>
<li>Q&amp;A</li>
</ul>
</section><section class="slide" id="slide_5" tabindex="-1">
<h1>Introduction to TDD</h1>
<ul>
<li>TDD stands for Test Driven Development</li>
<li>Methodology in Extreme Programming</li>
<li>Kent Back first wrote about it in 2003</li>
<li>Most important concept: tests first approach</li>
</ul>
</section><section class="slide" id="slide_6" tabindex="-1">
<h1>Tests first approach?</h1>
<ul>
<li>Think about your problem</li>
<li>Split your problem into smaller pieces</li>
<li>Solve your problems in the mantra of TDD
<ul>
<li>first write a test</li>
<li>don't write new code before writing a test for it</li>
</ul>
</li>
</ul>
</section><section class="slide" id="slide_7" tabindex="-1">
<h1>A TDD Cycle</h1>
<ul>
<li>Write a test for one small piece</li>
<li>The test fails</li>
<li>Implement as much to make the test pass</li>
<li>Tests pass :)</li>
<li>Clean code, refactor if necessary</li>
<li>Repeat</li>
</ul>
</section><section class="slide" id="slide_8" tabindex="-1">
<h1>Advantages of TDD</h1>
<ul>
<li>Rewarding :)</li>
<li>Your progress becomes visible</li>
<li>Ideal for pair/mob programming</li>
<li>Reduces debugging time</li>
<li>Integrateable with CI/CD tools</li>
</ul>
</section><section class="slide" id="slide_9" tabindex="-1">
<h1>Kinds of tests</h1>
<ul>
<li>Unit tests</li>
<li>Integration tests</li>
<li>Snapshot tests</li>
<li>Component tests</li>
<li>Visual tests</li>
<li>End 2 end tests</li>
</ul>
</section><section class="slide" id="slide_10" tabindex="-1">
<h1>Unit tests</h1>
<ul>
<li>test single functions in an isolated way</li>
<li>database queries, API fetches are replaced (mocked) by fixed results</li>
</ul>
</section><section class="slide" id="slide_11" tabindex="-1">
<h1>Integration tests</h1>
<ul>
<li>test &quot;integration&quot; of units</li>
<li>how does a group of units work together?</li>
</ul>
</section><section class="slide" id="slide_12" tabindex="-1">
<h1>Snapshot tests</h1>
<ul>
<li>check if the markup of a component renders correctly</li>
<li>can be useful for testing small pieces of markup</li>
<li>not recommended for very complex components</li>
<li><a target="_blank" rel="noopener noreferer" href="https://jestjs.io/docs/en/snapshot-testing">in-depth guide</a></li>
</ul>
</section><section class="slide" id="slide_13" tabindex="-1">
<h1>Component tests</h1>
<ul>
<li>Test functionality of a component</li>
<li>Works great with <a target="_blank" rel="noopener noreferer" href="https://storybook.js.org/docs/react/workflows/unit-testing">Storybook</a></li>
</ul>
</section><section class="slide" id="slide_14" tabindex="-1">
<h1>Visual tests</h1>
<ul>
<li>test if your component matches a screenshot</li>
<li>Works great with <a target="_blank" rel="noopener noreferer" href="https://storybook.js.org/docs/react/workflows/visual-testing">Storybook</a></li>
</ul>
</section><section class="slide" id="slide_15" tabindex="-1">
<h1>End-to-end tests</h1>
<ul>
<li>Test the complete functionality of your app</li>
<li><a target="_blank" rel="noopener noreferer" href="https://pptr.dev/">Puppeteer</a> - uses a headless chromium</li>
<li><a target="_blank" rel="noopener noreferer" href="https://www.cypress.io/">Cypress</a> - popular &amp; developer friendly</li>
<li><a target="_blank" rel="noopener noreferer" href="https://www.selenium.dev/">Selenium</a> - uses standardized WebDriver protocol (works with IE)</li>
</ul>
</section><section class="slide" id="slide_16" tabindex="-1">
<h1>Project setup with jest and TypeScript</h1>
<ul>
<li>via Babel
<ul>
<li>transpiles the test code to JavaScript</li>
<li>does no type-checking</li>
<li>you can do type-checking via the <code>tsc</code> compiler</li>
</ul>
</li>
<li>via ts-jest
<ul>
<li>no need to setup babel</li>
<li>type checking out of the box :)</li>
</ul>
</li>
</ul>
</section><section class="slide" id="slide_17" tabindex="-1">
<h1>Getting Started</h1>
<pre><code class="language-sh">mkdir my-project
npm init -y
npm i typescript jest @types/jest ts-jest -D
npx typescript --init
npx ts-jest config:init
</code></pre>
</section><section class="slide" id="slide_18" tabindex="-1">
<h1><code>jest.config.js</code></h1>
<pre><code class="language-js">module.exports = {
  preset: &quot;ts-jest&quot;,
  testEnvironment: &quot;node&quot;,
};
</code></pre>
</section><section class="slide" id="slide_19" tabindex="-1">
<h1>Test environments</h1>
<ul>
<li><code>node</code> - node-like environment</li>
<li><code>jsdom</code> - browser environment</li>
</ul>
</section><section class="slide" id="slide_20" tabindex="-1">
<h1>Layout of a test</h1>
<ul>
<li><code>describe</code>
<ul>
<li><code>beforeAll</code>, <code>beforeEach</code></li>
<li><code>afterAll</code>, <code>afterEach</code></li>
<li><code>test</code> / <code>it</code>
<ul>
<li><code>expect().toBe()</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</section><section class="slide" id="slide_21" tabindex="-1">
<h1>Example</h1>
<pre><code class="language-ts">describe(&quot;distance unit tests&quot;, () =&gt; {
  it(&quot;should return the distance between 2 points&quot;, () =&gt; {
    const b = { x: 1, y: 1 };
    const a = { x: 4, y: 5 };
    expect(distance(a, b)).toBe(5);
  });
});
</code></pre>
</section><section class="slide" id="slide_22" tabindex="-1">
<h1>Example implementation</h1>
<pre><code class="language-ts">type Point = { x: number; y: number };

export function distance(a: Point, b: Point) {
  const { abs, hypot } = Math;
  return hypot(abs(a.x - b.x, a.y - b.y));
}
</code></pre>
</section><section class="slide" id="slide_23" tabindex="-1">
<h1>A basic project setup</h1>
<ul>
<li><a target="_blank" rel="noopener noreferer" href="https://github.com/terabaud/tdd-code/">https://github.com/terabaud/tdd-code/</a></li>
</ul>
</section><section class="slide" id="slide_24" tabindex="-1">
<h1>Mocks</h1>
<ul>
<li>make functions out of test scope return expected results</li>
<li>abstract away dependencies for your isolated tests</li>
<li>Example for mocks: network calls, database queries, user input events</li>
</ul>
</section><section class="slide" id="slide_25" tabindex="-1">
<h1>How to mock in jest</h1>
<ul>
<li>import a mock from npm</li>
<li>overwrite a function with a mock implementation</li>
</ul>
</section><section class="slide" id="slide_26" tabindex="-1">
<h1>Example</h1>
<h2>canvas 2d/webgl mock</h2>
<pre><code class="language-sh">npm i jest-webgl-canvas-mock -D
</code></pre>
<pre><code class="language-js">module.exports = {
  preset: &quot;ts-jest&quot;,
  testEnvironment: &quot;jsdom&quot;,
  setupFiles: [&quot;jest-webgl-canvas-mock&quot;],
};
</code></pre>
</section><section class="slide" id="slide_27" tabindex="-1">
<h1>Example: jest.mock 1/2</h1>
<pre><code class="language-js">import fetch from &quot;node-fetch&quot;;
import { mocked } from &quot;ts-jest/utils&quot;;

import { getPerson } from &quot;./star-wars-api&quot;;

jest.mock(&quot;node-fetch&quot;, () =&gt; jest.fn());
</code></pre>
</section><section class="slide" id="slide_28" tabindex="-1">
<h1>Example: jest.mock 2/2</h1>
<pre><code class="language-js">describe(&quot;My test&quot;, () =&gt; {
  it(&quot;should fetch Luke Skywalker from the Star Wars API&quot;, async () =&gt; {
    mocked(fetch).mockImplementation((): Promise&lt;any&gt; =&gt; {
      return Promise.resolve({
        json: () =&gt; Promise.resolve({ name: &quot;Luke Skywalker&quot; }),
      });
    });
    const person = await getPerson(1);
    expect(person.name).toBe(&quot;Luke Skywalker&quot;);
  });
});
</code></pre>
</section><section class="slide" id="slide_29" tabindex="-1">
<h1>Mock by reassigning</h1>
<pre><code class="language-js">let now = 0;
const originalPerfNow: () =&gt; number = global.performance.now;

beforeEach(() =&gt; {
  now = 0;
  global.performance.now = () =&gt; now;
});

afterEach(() =&gt; {
  global.performance.now = originalPerfNow;
});
</code></pre>
</section><section class="slide" id="slide_30" tabindex="-1">
<h1>Asset imports 1/2</h1>
<h2><code>./jest/stub-transformer.js</code></h2>
<pre><code class="language-js">module.exports = {
  process: () =&gt; &quot;module.exports = {};&quot;,
  getCacheKey: () =&gt; &quot;stub-transformer&quot;,
};
</code></pre>
</section><section class="slide" id="slide_31" tabindex="-1">
<h1>Asset imports 2/2</h1>
<h2><code>jest.config.js</code></h2>
<pre><code class="language-js">module.exports = {
  transform: {
    &quot;\\.(css|less|scss)$&quot;: &quot;./jest/stub-transformer.js&quot;,
  },
};
</code></pre>
</section><section class="slide" id="slide_32" tabindex="-1">
<h1>Real life code examples</h1>
<ul>
<li><a target="_blank" rel="noopener noreferer" href="https://github.com/shader-art/shader-art/">https://github.com/shader-art/shader-art/</a></li>
<li><a target="_blank" rel="noopener noreferer" href="https://github.com/terabaud/frontm8er">https://github.com/terabaud/frontm8er</a></li>
<li><a target="_blank" rel="noopener noreferer" href="https://github.com/ella-math/">https://github.com/terabaud/ella-math/</a></li>
<li><a target="_blank" rel="noopener noreferer" href="https://github.com/terabaud/talentbook/">https://github.com/terabaud/talentbook/</a></li>
</ul>
</section><section class="slide" id="slide_33" tabindex="-1">
<h1>Thank you :)</h1>
</section><section class="slide" id="slide_34" tabindex="-1">
<h1>Link to my slides</h1>
<ul>
<li><a target="_blank" rel="noopener noreferer" href="https://terabaud.github.io/tdd-talk/">https://terabaud.github.io/tdd-talk/</a></li>
</ul>
<h2>Further Resources</h2>
<ul>
<li><a target="_blank" rel="noopener noreferer" href="https://jestjs.io">https://jestjs.io</a></li>
<li><a target="_blank" rel="noopener noreferer" href="https://kulshekhar.github.io/ts-jest/">https://kulshekhar.github.io/ts-jest/</a></li>
<li><a target="_blank" rel="noopener noreferer" href="https://enzymejs.github.io/enzyme/">https://enzymejs.github.io/enzyme/</a></li>
</ul>
<h2>Recommended Talk</h2>
<ul>
<li><a target="_blank" rel="noopener noreferer" href="https://www.youtube.com/watch?v=V7QRcnnMoKI">Mirjam Bäuerlein @ RuhrJS 2019 - a tale of dog training and test-driven development</a></li>
</ul>
</section></main><script src="prism/prism.js"></script><script src="scrolly.js"></script></body></html>